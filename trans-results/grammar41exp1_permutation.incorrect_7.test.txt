2024-12-19 09:48:04 | INFO | fairseq.tasks.text_to_speech | Please install tensorboardX: pip install tensorboardX
2024-12-19 09:48:06 | INFO | fairseq_cli.eval_lm | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': 'checkpoints/grammar41exp1_permutation/7-transformer/checkpoint_best.pt', 'post_process': None, 'quiet': True, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': False, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': True, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': None, 'task': {'_name': 'language_modeling', 'data': 'data-bin/grammar41exp1_permutation/incorrect_7-dataset', 'sample_break_mode': 'none', 'tokens_per_sample': 512, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 1, 'batch_size': None, 'batch_size_valid': None, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'criterion': {'_name': 'cross_entropy', 'sentence_avg': True}, 'optimizer': None, 'lr_scheduler': {'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2024-12-19 09:48:06 | INFO | fairseq.tasks.language_modeling | dictionary: 1136 types
2024-12-19 09:48:06 | INFO | fairseq_cli.eval_lm | loading model(s) from checkpoints/grammar41exp1_permutation/7-transformer/checkpoint_best.pt
/workspace/artificial-languages/fairseq/fairseq/checkpoint_utils.py:340: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state = torch.load(f, map_location=torch.device("cpu"))
2024-12-19 09:48:09 | INFO | fairseq_cli.eval_lm | num. model params: 10,038,784
2024-12-19 09:48:09 | INFO | fairseq.data.data_utils | loaded 136 examples from: data-bin/grammar41exp1_permutation/incorrect_7-dataset/test
2024-12-19 09:48:09 | INFO | fairseq_cli.eval_lm | data-bin/grammar41exp1_permutation/incorrect_7-dataset test 1 examples
2024-12-19 09:48:09 | INFO | fairseq.tasks.fairseq_task | can_reuse_epoch_itr = True
2024-12-19 09:48:09 | INFO | fairseq.tasks.fairseq_task | reuse_dataloader = True
2024-12-19 09:48:09 | INFO | fairseq.tasks.fairseq_task | rebuild_batches = False
2024-12-19 09:48:09 | INFO | fairseq.tasks.fairseq_task | creating new batches for epoch 1
2024-12-19 09:48:11 | INFO | fairseq_cli.eval_lm | 0 red [-14.251528]	introvert [-4.861553]	</s> [-1.574599]	extra-small [-19.545769]	close [-5.706989]	</s> [-1.081252]	all [-18.339369]	intercede [-4.868207]	</s> [-0.831081]	site [-15.066283]	folk [-7.606968]	</s> [-1.118727]	notable [-19.127649]	slaughter [-4.198147]	</s> [-0.947311]	obese [-19.152147]	slaughter [-3.733340]	</s> [-0.904712]	bone [-17.117384]	rich [-7.422890]	</s> [-1.842531]	your [-20.227989]	rich [-8.080698]	</s> [-1.737074]	the [-15.324636]	rich [-8.046255]	</s> [-1.595465]	scaly [-18.227806]	secularize [-4.757194]	</s> [-0.576641]	wary [-18.670887]	secularize [-4.457412]	</s> [-0.648453]	rock [-16.125107]	secularize [-8.159965]	</s> [-0.656277]	tense [-16.745380]	racketeer [-5.591182]	</s> [-0.707242]	flaky [-19.487612]	racketeer [-5.104088]	</s> [-0.730650]	coast [-15.057366]	still [-8.122304]	</s> [-0.815636]	steal [-15.094245]	number [-6.901200]	</s> [-0.732141]	awesome [-19.206261]	revitalise [-5.098663]	</s> [-0.628973]	contract [-15.614985]	overspecialize [-7.611804]	</s> [-0.695588]	another [-17.020979]	weird [-6.111835]	</s> [-1.499789]	overspecialize [-19.357744]	weird [-6.655849]	</s> [-1.559519]	lonely [-20.430134]	rediscover [-3.899517]	</s> [-0.802869]	elastic [-19.894123]	mispronounce [-5.460067]	</s> [-1.029530]	reason [-16.064629]	overemphasize [-7.010342]	</s> [-0.795726]	ecstatic [-19.216652]	choke [-4.366036]	</s> [-0.786021]	digital [-18.258314]	choke [-4.140303]	</s> [-0.806220]	mild [-18.389557]	choke [-4.253504]	</s> [-0.826753]	potable [-18.477234]	crosscheck [-5.173339]	</s> [-0.616785]	sick [-18.581879]	crosscheck [-5.154749]	</s> [-0.610767]	host [-16.386770]	crash [-7.446109]	</s> [-0.797651]	mission [-15.702779]	crash [-8.083736]	</s> [-0.808788]	research [-15.956367]	splash [-6.554861]	</s> [-0.669579]	ashamed [-18.178822]	splash [-4.389122]	</s> [-0.662681]	engineering [-15.936101]	spearhead [-8.105567]	</s> [-0.909089]	lustrous [-17.126402]	spearhead [-4.789586]	</s> [-0.916902]	lucky [-17.786577]	spearhead [-4.583928]	</s> [-0.879860]	reliable [-19.485636]	influence [-4.110818]	</s> [-0.602775]	precious [-19.452950]	influence [-4.784518]	</s> [-0.664381]	awesome [-19.399403]	jeopardize [-4.824366]	</s> [-0.794266]	headquarter [-19.888987]	sweet [-6.413521]	</s> [-1.428995]	idle [-16.875626]	sweet [-5.732248]	</s> [-1.696640]	good [-18.012348]	get [-3.962758]	</s> [-0.755419]	unusual [-18.346716]	dehumanize [-4.570383]	</s> [-0.968183]	healthy [-18.232927]	dehumanize [-3.926967]	</s> [-0.927630]	golden [-17.986517]	slap [-4.846892]	</s> [-0.977199]	book [-16.369131]	slap [-6.703728]	</s> [-1.005856]	feminine [-18.467518]	blaspheme [-5.445062]	</s> [-0.761381]	education [-16.040195]	blaspheme [-7.578821]	</s> [-0.709796]	pristine [-17.406096]	back [-4.985802]	</s> [-0.883105]	memory [-15.906891]	follow [-8.312390]	</s> [-0.845323]	aggravating [-18.644241]	blackguard [-5.093361]	</s> [-0.722017]	pungent [-18.488428]	blackguard [-4.475233]	</s> [-0.737446]	meek [-18.727341]	shove [-4.515878]	</s> [-0.844290]	lonely [-20.508154]	provision [-4.417975]	</s> [-0.645156]	this [-19.417984]	undervalue [-5.115384]	</s> [-0.757105]	drawing [-16.504976]	undervalue [-7.486483]	</s> [-0.734023]	signature [-18.021820]	give [-6.539020]	</s> [-0.773893]	vain [-17.956329]	privilege [-4.870494]	</s> [-0.827661]	salty [-18.958117]	privilege [-4.650788]	</s> [-0.761994]	wealthy [-20.194683]	decentralize [-5.225317]	</s> [-0.776576]	mail [-16.262760]	misbehave [-7.596213]	</s> [-0.756194]	pick [-16.476797]	misbehave [-7.827167]	</s> [-0.715725]	incident [-16.408537]	brutalize [-7.804255]	</s> [-0.800432]	troubled [-17.882265]	brutalize [-5.459115]	</s> [-0.854367]	shake [-17.524460]	dress [-7.492229]	</s> [-0.864944]	broad [-15.470342]	rustle [-7.864491]	</s> [-1.102614]	irresponsible [-19.279732]	rustle [-4.924372]	</s> [-0.969791]	powerless [-19.756775]	wheelbarrow [-4.310243]	</s> [-0.813322]	deep [-17.490747]	wheelbarrow [-4.558993]	</s> [-0.757480]	biodegradable [-19.181564]	wheelbarrow [-4.547763]	</s> [-0.752380]	special [-16.851759]	bring [-8.008346]	</s> [-0.856461]	dazzling [-18.291565]	bring [-4.675095]	</s> [-0.820730]	timely [-18.985352]	hydroplane [-4.722377]	</s> [-0.884626]	signature [-18.097719]	hydroplane [-5.681941]	</s> [-0.876520]	reliable [-19.786900]	inconvenience [-4.310690]	</s> [-0.968807]	research [-15.993872]	inconvenience [-7.708679]	</s> [-0.910098]	broken [-19.394695]	inconvenience [-3.770033]	</s> [-0.893713]	slippery [-18.196507]	inconvenience [-3.700883]	</s> [-0.842585]	careful [-17.704672]	track [-4.731805]	</s> [-0.662613]	city [-17.452080]	mountebank [-7.970982]	</s> [-0.656963]	extra-small [-19.719419]	pressurize [-5.224874]	</s> [-0.621536]	pungent [-18.446598]	soft [-4.396081]	</s> [-0.872255]	till [-15.930715]	promenade [-7.922629]	</s> [-0.615509]	hot [-17.193571]	sneeze [-4.530041]	</s> [-0.766736]	bread [-16.226404]	booby [-7.181995]	</s> [-0.936364]	clock [-16.523779]	booby [-7.380229]	</s> [-0.957883]	irresponsible [-18.815157]	carry [-4.848129]	</s> [-0.708600]	clerk [-17.287416]	weasel [-7.311703]	</s> [-0.865356]	sentimental [-18.677185]	glamorize [-4.764385]	</s> [-0.751084]	doubt [-17.756016]	headquarter [-7.931697]	</s> [-0.697722]	admired [-17.821035]	headquarter [-5.089935]	</s> [-0.692093]	winged [-20.590157]	come [-4.167259]	</s> [-0.689024]	plastic [-17.862001]	criticise [-6.216849]	</s> [-0.696925]	maximum [-16.903181]	criticise [-8.337720]	</s> [-0.685457]	incomparable [-19.458904]	key [-5.108893]	</s> [-0.559447]	shift [-16.283026]	bump [-7.846768]	</s> [-0.747959]	scaly [-18.599384]	power [-5.134923]	</s> [-0.552407]	ill-fated [-19.323799]	power [-4.887152]	</s> [-0.588181]	secret [-16.580921]	intermarry [-5.179354]	</s> [-0.995708]	math [-17.927650]	hero [-6.191628]	</s> [-1.011245]	appropriate [-17.887938]	hero [-5.143645]	</s> [-1.002388]	needy [-19.556578]	vault [-5.521996]	</s> [-0.678441]	cup [-17.598677]	vault [-7.135540]	</s> [-0.631083]	overcooked [-18.437426]	vault [-5.024304]	</s> [-0.624349]	aggravating [-18.961636]	prescribe [-5.109814]	</s> [-0.665052]	rice [-16.092379]	buttonhole [-8.255384]	</s> [-0.656556]	reward [-16.741705]	apologize [-7.266088]	</s> [-0.721738]	simplistic [-15.877447]	medium [-5.906641]	</s> [-2.286511]	incident [-16.011971]	medium [-8.087971]	</s> [-2.378932]	lip [-16.357775]	replenish [-8.722939]	</s> [-0.786679]	tip [-18.494352]	replenish [-6.905701]	</s> [-0.745612]	potable [-18.446163]	stanchion [-4.851743]	</s> [-0.612269]	rich [-15.356581]	stanchion [-8.022484]	</s> [-0.655916]	homework [-17.349815]	interfere [-8.380221]	</s> [-0.926633]	professor [-16.903488]	interfere [-6.432221]	</s> [-0.862756]	complex [-14.148894]	disrespect [-5.128457]	</s> [-0.694861]	unique [-16.397268]	rubber [-7.329075]	</s> [-0.947352]	secret [-16.274782]	demagnetise [-5.013298]	</s> [-0.761943]	careful [-17.433752]	misconduct [-4.246116]	</s> [-0.742412]	second [-18.026096]	misconduct [-4.402751]	</s> [-0.760893]	anxiety [-16.795063]	constrict [-7.015269]	</s> [-0.732296]	haunting [-19.193041]	constrict [-5.351714]	</s> [-0.762303]	needy [-19.524563]	constrict [-4.798515]	</s> [-0.788807]	second [-18.133301]	bucket [-5.064414]	</s> [-1.068275]	passenger [-17.112633]	bucket [-6.975694]	</s> [-1.101486]	special [-16.642551]	interchange [-7.482642]	</s> [-0.894233]	national [-16.433409]	disembowel [-6.430194]	</s> [-0.720337]	reliable [-19.775181]	disembowel [-4.572752]	</s> [-0.705399]	boy [-16.751501]	square [-7.818485]	</s> [-0.957875]	unwritten [-19.474073]	distemper [-4.750377]	</s> [-0.989835]	responsible [-17.593000]	fall [-4.855992]	</s> [-0.806357]	snow [-15.710330]	fall [-6.249533]	</s> [-0.800881]	blind [-15.401651]	pitchfork [-9.320513]	</s> [-0.727506]	mistake [-17.143913]	pitchfork [-7.370863]	</s> [-0.738271]	throat [-15.884080]	intellectualize [-7.521914]	</s> [-0.683927]	grandiose [-19.067408]	run [-6.218890]	</s> [-0.991485]	bone [-17.484713]	run [-8.074319]	</s> [-0.849607]
2024-12-19 09:48:11 | INFO | fairseq_cli.eval_lm | Evaluated 408 tokens in 1.0s (401.58 tokens/s)
2024-12-19 09:48:11 | INFO | fairseq_cli.eval_lm | Loss (base 2): 11.7966, Perplexity: 3557.50
