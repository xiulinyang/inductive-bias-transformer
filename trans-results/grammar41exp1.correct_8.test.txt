2024-12-19 10:17:45 | INFO | fairseq.tasks.text_to_speech | Please install tensorboardX: pip install tensorboardX
2024-12-19 10:17:47 | INFO | fairseq_cli.eval_lm | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': 'checkpoints/grammar41exp1/8-transformer/checkpoint_best.pt', 'post_process': None, 'quiet': True, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': False, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': True, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': None, 'task': {'_name': 'language_modeling', 'data': 'data-bin/grammar41exp1/correct_8-dataset', 'sample_break_mode': 'none', 'tokens_per_sample': 512, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 1, 'batch_size': None, 'batch_size_valid': None, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'criterion': {'_name': 'cross_entropy', 'sentence_avg': True}, 'optimizer': None, 'lr_scheduler': {'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2024-12-19 10:17:47 | INFO | fairseq.tasks.language_modeling | dictionary: 1136 types
2024-12-19 10:17:47 | INFO | fairseq_cli.eval_lm | loading model(s) from checkpoints/grammar41exp1/8-transformer/checkpoint_best.pt
/workspace/artificial-languages/fairseq/fairseq/checkpoint_utils.py:340: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state = torch.load(f, map_location=torch.device("cpu"))
2024-12-19 10:17:50 | INFO | fairseq_cli.eval_lm | num. model params: 10,038,784
2024-12-19 10:17:50 | INFO | fairseq.data.data_utils | loaded 143 examples from: data-bin/grammar41exp1/correct_8-dataset/test
2024-12-19 10:17:50 | INFO | fairseq_cli.eval_lm | data-bin/grammar41exp1/correct_8-dataset test 1 examples
2024-12-19 10:17:50 | INFO | fairseq.tasks.fairseq_task | can_reuse_epoch_itr = True
2024-12-19 10:17:50 | INFO | fairseq.tasks.fairseq_task | reuse_dataloader = True
2024-12-19 10:17:50 | INFO | fairseq.tasks.fairseq_task | rebuild_batches = False
2024-12-19 10:17:50 | INFO | fairseq.tasks.fairseq_task | creating new batches for epoch 1
2024-12-19 10:17:51 | INFO | fairseq_cli.eval_lm | 0 your [-14.237589]	decentralize [-8.741077]	</s> [-1.551778]	hundred [-12.684778]	keep [-8.935622]	</s> [-2.944617]	a [-13.517591]	keep [-9.475201]	</s> [-3.374387]	hundred [-13.048353]	soft [-10.929957]	</s> [-2.259971]	your [-13.666459]	pitchfork [-9.819256]	</s> [-1.628879]	hundred [-13.218498]	pitchfork [-9.964682]	</s> [-1.636175]	hundred [-13.183075]	bump [-10.387855]	</s> [-1.728005]	hundred [-12.957830]	sneeze [-9.852743]	</s> [-1.950540]	your [-13.220870]	distemper [-9.000392]	</s> [-1.254190]	your [-13.004446]	disrespect [-9.912956]	</s> [-1.218327]	hundred [-12.809585]	disrespect [-10.046555]	</s> [-1.184704]	your [-13.191492]	dillydally [-9.429264]	</s> [-1.607733]	one [-13.528069]	dillydally [-9.664692]	</s> [-1.670382]	your [-13.206735]	still [-9.913054]	</s> [-1.836194]	my [-13.066447]	still [-10.287442]	</s> [-1.779357]	an [-14.273988]	square [-9.995293]	</s> [-1.931722]	a [-13.795428]	square [-9.080934]	</s> [-1.858366]	the [-13.582614]	square [-9.732623]	</s> [-1.860935]	the [-13.963291]	choke [-10.518637]	</s> [-1.415515]	your [-13.798756]	choke [-10.402327]	</s> [-1.307866]	your [-13.716044]	carry [-9.630699]	</s> [-1.338832]	a [-13.835428]	carry [-10.077236]	</s> [-1.150377]	hundred [-13.516671]	jeopardize [-9.761970]	</s> [-1.160316]	your [-13.544092]	jeopardize [-9.739659]	</s> [-1.247145]	a [-13.763614]	brutalize [-9.572622]	</s> [-1.112306]	hundred [-13.326673]	brutalize [-9.660651]	</s> [-1.046609]	your [-13.605619]	introvert [-9.789771]	</s> [-1.138259]	your [-13.522059]	prejudice [-10.066181]	</s> [-1.289732]	hundred [-13.534931]	prejudice [-10.119708]	</s> [-1.351386]	your [-13.386740]	undervalue [-9.791797]	</s> [-1.347791]	hundred [-13.266951]	undervalue [-10.175672]	</s> [-1.397857]	your [-13.411541]	overspecialize [-10.641071]	</s> [-1.142992]	an [-14.092052]	slaughter [-10.236670]	</s> [-1.226355]	hundred [-13.001639]	back [-6.439809]	</s> [-2.232674]	my [-13.371323]	back [-5.852755]	</s> [-2.154399]	an [-14.111449]	break [-10.121897]	</s> [-1.483301]	hundred [-13.105584]	interfere [-9.470063]	</s> [-1.208229]	your [-13.276739]	interfere [-9.938032]	</s> [-1.244198]	hundred [-13.071063]	criticise [-9.827065]	</s> [-1.252216]	the [-13.797370]	crash [-10.007981]	</s> [-1.267759]	your [-13.367525]	number [-9.979803]	</s> [-0.854283]	hundred [-13.037885]	slap [-10.365242]	</s> [-1.195336]	an [-14.294306]	intermarry [-10.889492]	</s> [-0.816298]	hundred [-13.225311]	intermarry [-10.799127]	</s> [-0.853512]	the [-13.710825]	misbehave [-10.176994]	</s> [-1.236453]	your [-13.210849]	misbehave [-10.334419]	</s> [-1.141059]	hundred [-13.179329]	intellectualize [-10.961947]	</s> [-1.256489]	your [-13.259625]	splash [-9.894324]	</s> [-1.249948]	hundred [-13.242221]	splash [-9.963699]	</s> [-1.204718]	my [-13.289545]	mispronounce [-10.180096]	</s> [-1.420656]	a [-13.551631]	folk [-10.071781]	</s> [-1.768198]	your [-13.192928]	folk [-10.578665]	</s> [-1.703052]	your [-13.200349]	revitalise [-9.572941]	</s> [-1.093018]	an [-14.130349]	shove [-10.393069]	</s> [-1.344072]	your [-13.080809]	shove [-10.172249]	</s> [-1.273409]	your [-13.134964]	sound [-10.073772]	</s> [-1.497707]	hundred [-13.003238]	booby [-10.437352]	</s> [-1.546446]	one [-13.782827]	booby [-9.779507]	</s> [-1.440342]	an [-14.125647]	booby [-10.254414]	</s> [-1.556685]	hundred [-13.079985]	overemphasize [-10.468875]	</s> [-1.216908]	hundred [-12.930574]	blaspheme [-9.686539]	</s> [-1.242480]	your [-13.190231]	blaspheme [-9.085135]	</s> [-1.135262]	an [-14.242470]	blaspheme [-10.133606]	</s> [-1.208426]	your [-12.976356]	privilege [-9.838572]	</s> [-1.176066]	your [-13.257056]	follow [-9.812243]	</s> [-0.878012]	hundred [-12.995609]	follow [-9.167113]	</s> [-0.909016]	one [-13.904304]	mountebank [-10.324761]	</s> [-1.365424]	an [-14.343397]	medium [-5.237226]	</s> [-2.527238]	your [-13.255545]	medium [-5.013821]	</s> [-2.660198]	hundred [-13.091238]	buttonhole [-10.237816]	</s> [-1.724673]	hundred [-13.003488]	hydroplane [-10.954913]	</s> [-1.309085]	my [-13.295554]	hydroplane [-10.521527]	</s> [-1.357106]	hundred [-12.825647]	rich [-5.599657]	</s> [-3.272302]	an [-14.240562]	rich [-5.640639]	</s> [-3.321780]	your [-13.168940]	commercialize [-9.614657]	</s> [-1.118516]	your [-13.119235]	fall [-10.254166]	</s> [-1.089176]	hundred [-12.839465]	fall [-10.426457]	</s> [-1.116602]	hundred [-12.921632]	come [-10.697575]	</s> [-1.061318]	my [-13.183935]	commingle [-10.493671]	</s> [-1.677129]	an [-14.167226]	commingle [-9.932276]	</s> [-1.603171]	hundred [-13.050808]	dehumanize [-10.392928]	</s> [-0.891780]	one [-13.956107]	smooth [-10.623937]	</s> [-1.357019]	your [-13.077735]	smooth [-9.871695]	</s> [-1.328112]	hundred [-13.076777]	blind [-5.128922]	</s> [-2.666030]	the [-13.647417]	blind [-5.804204]	</s> [-2.655231]	a [-13.504351]	blind [-5.906389]	</s> [-2.783778]	your [-13.261630]	blind [-5.888784]	</s> [-2.706455]	a [-13.466710]	wheelbarrow [-9.679161]	</s> [-1.470118]	an [-14.351313]	wheelbarrow [-9.901806]	</s> [-1.505576]	hundred [-13.120166]	close [-8.798498]	</s> [-2.189872]	a [-13.740656]	close [-9.626429]	</s> [-2.336766]	a [-13.642526]	intercede [-9.975373]	</s> [-1.430399]	your [-13.504489]	ginger [-9.834382]	</s> [-1.172025]	my [-13.353325]	ginger [-9.688143]	</s> [-1.233105]	an [-14.331886]	glamorize [-11.113317]	</s> [-1.169415]	a [-13.437619]	glamorize [-11.896255]	</s> [-1.335652]	one [-14.000655]	replenish [-10.470385]	</s> [-1.552374]	your [-13.503613]	replenish [-9.975425]	</s> [-1.258066]	your [-13.549964]	influence [-10.638346]	</s> [-1.511756]	your [-13.410935]	overcharge [-10.282448]	</s> [-1.472681]	the [-13.395103]	overcharge [-11.268124]	</s> [-1.494775]	hundred [-12.930180]	track [-10.623455]	</s> [-1.570242]	hundred [-13.022656]	constrict [-9.935240]	</s> [-1.158852]	one [-14.018619]	constrict [-10.336728]	</s> [-1.115976]	an [-14.432152]	burlesque [-10.187593]	</s> [-1.537918]	your [-13.419797]	burlesque [-9.951958]	</s> [-1.503406]	one [-14.087186]	burlesque [-9.674890]	</s> [-1.475070]	hundred [-13.089737]	fertilize [-10.243063]	</s> [-1.538789]	one [-13.744794]	fertilize [-10.318241]	</s> [-1.436757]	your [-13.379379]	sweet [-6.483860]	</s> [-2.115058]	my [-13.138500]	sweet [-6.038494]	</s> [-2.109951]	your [-13.257326]	hero [-9.792330]	</s> [-1.358604]	hundred [-12.836674]	hero [-10.793901]	</s> [-1.256974]	your [-13.259411]	circumcise [-10.133277]	</s> [-1.128164]	the [-13.449335]	weasel [-11.507771]	</s> [-1.224266]	an [-14.457804]	weasel [-11.106499]	</s> [-1.174384]	hundred [-12.937322]	spearhead [-10.930318]	</s> [-1.037603]	your [-13.234857]	dress [-10.037370]	</s> [-1.339397]	an [-14.209424]	headquarter [-10.500700]	</s> [-0.972563]	hundred [-12.694524]	headquarter [-9.955471]	</s> [-0.906852]	a [-13.587234]	headquarter [-10.225996]	</s> [-1.079935]	your [-13.314042]	listen [-9.655606]	</s> [-1.685115]	a [-13.202514]	listen [-10.777874]	</s> [-1.671010]	your [-13.240238]	outbalance [-9.795261]	</s> [-1.666239]	hundred [-13.015635]	gallivant [-9.916472]	</s> [-1.021871]	your [-13.484947]	gallivant [-9.570129]	</s> [-1.114077]	hundred [-12.963911]	reemphasize [-10.484230]	</s> [-1.361433]	my [-13.477720]	reemphasize [-10.542562]	</s> [-1.430780]	your [-13.160333]	pressurize [-9.969113]	</s> [-1.369150]	hundred [-12.844823]	pressurize [-10.054495]	</s> [-1.181037]	your [-13.324302]	prescribe [-9.326414]	</s> [-0.819175]	hundred [-12.885687]	key [-9.246315]	</s> [-1.439020]	your [-13.189976]	key [-9.127785]	</s> [-1.381308]	hundred [-12.659836]	interchange [-10.601397]	</s> [-1.085629]	a [-13.826506]	misconduct [-10.184519]	</s> [-1.196985]	hundred [-12.984707]	misconduct [-10.265386]	</s> [-1.140595]	your [-13.363520]	bucket [-10.232365]	</s> [-0.953067]	hundred [-12.992479]	bucket [-10.211040]	</s> [-0.966842]	a [-13.635188]	bucket [-10.591248]	</s> [-0.898371]	a [-13.769743]	rustle [-10.109136]	</s> [-1.081029]	an [-14.276537]	rustle [-10.722095]	</s> [-1.176852]	hundred [-12.852538]	backtrack [-9.164102]	</s> [-1.367871]	your [-13.172663]	backtrack [-9.407467]	</s> [-1.354094]
2024-12-19 10:17:51 | INFO | fairseq_cli.eval_lm | Evaluated 429 tokens in 1.0s (436.45 tokens/s)
2024-12-19 10:17:51 | INFO | fairseq_cli.eval_lm | Loss (base 2): 11.8346, Perplexity: 3652.35
