2024-12-19 07:30:34 | INFO | fairseq.tasks.text_to_speech | Please install tensorboardX: pip install tensorboardX
2024-12-19 07:30:37 | INFO | fairseq_cli.eval_lm | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': 'checkpoints/grammar41exp1_permutation/2-transformer/checkpoint_best.pt', 'post_process': None, 'quiet': True, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': False, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': True, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': None, 'task': {'_name': 'language_modeling', 'data': 'data-bin/grammar41exp1_permutation/incorrect_2-dataset', 'sample_break_mode': 'none', 'tokens_per_sample': 512, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 1, 'batch_size': None, 'batch_size_valid': None, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'criterion': {'_name': 'cross_entropy', 'sentence_avg': True}, 'optimizer': None, 'lr_scheduler': {'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2024-12-19 07:30:37 | INFO | fairseq.tasks.language_modeling | dictionary: 1136 types
2024-12-19 07:30:37 | INFO | fairseq_cli.eval_lm | loading model(s) from checkpoints/grammar41exp1_permutation/2-transformer/checkpoint_best.pt
/workspace/artificial-languages/fairseq/fairseq/checkpoint_utils.py:340: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state = torch.load(f, map_location=torch.device("cpu"))
2024-12-19 07:30:40 | INFO | fairseq_cli.eval_lm | num. model params: 10,038,784
2024-12-19 07:30:40 | INFO | fairseq.data.data_utils | loaded 155 examples from: data-bin/grammar41exp1_permutation/incorrect_2-dataset/test
2024-12-19 07:30:40 | INFO | fairseq_cli.eval_lm | data-bin/grammar41exp1_permutation/incorrect_2-dataset test 1 examples
2024-12-19 07:30:40 | INFO | fairseq.tasks.fairseq_task | can_reuse_epoch_itr = True
2024-12-19 07:30:40 | INFO | fairseq.tasks.fairseq_task | reuse_dataloader = True
2024-12-19 07:30:40 | INFO | fairseq.tasks.fairseq_task | rebuild_batches = False
2024-12-19 07:30:40 | INFO | fairseq.tasks.fairseq_task | creating new batches for epoch 1
2024-12-19 07:30:42 | INFO | fairseq_cli.eval_lm | 0 miserly [-13.613544]	promenade [-6.147192]	</s> [-0.512720]	discount [-14.834495]	promenade [-5.972359]	</s> [-0.385218]	research [-15.124854]	promenade [-6.316644]	</s> [-0.493037]	revolving [-17.622566]	pitchfork [-4.883050]	</s> [-0.587645]	plastic [-14.505714]	pitchfork [-4.368769]	</s> [-0.583318]	reward [-16.658915]	slaughter [-5.644937]	</s> [-0.545797]	this [-17.515593]	choke [-5.281512]	</s> [-0.472501]	slippery [-18.581511]	choke [-4.731881]	</s> [-0.484440]	plastic [-14.399884]	follow [-4.949604]	</s> [-0.488846]	internet [-15.424067]	follow [-5.780126]	</s> [-0.531650]	sentimental [-17.396988]	follow [-4.449920]	</s> [-0.525378]	kosher [-16.799999]	follow [-4.680496]	</s> [-0.491314]	heavenly [-15.500571]	follow [-3.780258]	</s> [-0.569000]	rich [-14.486152]	shove [-7.807961]	</s> [-0.441715]	incident [-13.564885]	apologize [-7.382069]	</s> [-0.464632]	funny [-14.720419]	apologize [-5.825714]	</s> [-0.421584]	light [-17.641026]	ginger [-4.764456]	</s> [-0.326092]	trivial [-17.466352]	fall [-4.708005]	</s> [-0.410965]	friend [-15.535643]	booby [-6.602399]	</s> [-0.444404]	palatable [-17.695097]	booby [-4.656940]	</s> [-0.436333]	utilized [-17.544424]	privilege [-4.948931]	</s> [-0.401064]	music [-15.166390]	privilege [-7.263500]	</s> [-0.390607]	responsible [-18.625473]	privilege [-4.577981]	</s> [-0.342846]	potable [-16.335264]	stand [-4.046417]	</s> [-0.538477]	feminine [-18.503374]	bump [-5.062218]	</s> [-0.490224]	exalted [-18.271219]	bump [-4.928288]	</s> [-0.486346]	employ [-14.826791]	give [-7.062687]	</s> [-0.378175]	flashy [-17.327618]	give [-4.926992]	</s> [-0.401910]	rubbery [-16.814358]	sneeze [-6.105823]	</s> [-0.421299]	manufacturer [-15.354448]	sneeze [-6.764353]	</s> [-0.437631]	pale [-16.927542]	sneeze [-6.004805]	</s> [-0.440656]	appropriate [-18.066605]	sneeze [-5.929996]	</s> [-0.460524]	relationship [-14.950732]	blackguard [-5.890121]	</s> [-0.480376]	mild [-17.526678]	blackguard [-4.915524]	</s> [-0.480747]	race [-16.026207]	wheelbarrow [-6.340972]	</s> [-0.490601]	peace [-15.084920]	prejudice [-6.359644]	</s> [-0.480275]	hand [-15.236488]	intercede [-5.917070]	</s> [-0.488779]	introduction [-14.490867]	fertilize [-6.357133]	</s> [-0.442190]	second [-17.352011]	fertilize [-5.432454]	</s> [-0.434765]	outstanding [-17.873625]	hydroplane [-5.280199]	</s> [-0.534044]	sister [-16.465904]	hydroplane [-6.709792]	</s> [-0.552849]	finance [-14.385150]	rustle [-6.469534]	</s> [-0.492909]	structure [-14.090585]	rustle [-6.122577]	</s> [-0.519867]	uncommon [-16.080572]	burlesque [-5.234925]	</s> [-0.406933]	plastic [-14.758084]	dillydally [-5.530211]	</s> [-0.547217]	fearless [-17.265108]	dillydally [-4.691029]	</s> [-0.540772]	painting [-15.323300]	introvert [-7.171943]	</s> [-0.406420]	pristine [-15.186913]	introvert [-5.045995]	</s> [-0.453107]	rich [-14.332396]	bucket [-7.047117]	</s> [-0.465036]	novel [-16.984419]	dress [-4.829990]	</s> [-0.447573]	irresponsible [-16.044588]	folk [-4.848505]	</s> [-0.430409]	responsible [-17.918072]	provision [-4.521740]	</s> [-0.414996]	kosher [-17.068151]	glamorize [-5.224241]	</s> [-0.537049]	come [-17.106791]	rich [-6.072170]	</s> [-1.095855]	constrict [-17.049311]	rich [-6.246739]	</s> [-1.120783]	maximum [-14.561801]	undervalue [-7.414097]	</s> [-0.611647]	predetermine [-17.402996]	square [-8.051059]	</s> [-0.622765]	golden [-17.509403]	square [-6.310311]	</s> [-0.579147]	get [-17.945185]	square [-7.407015]	</s> [-0.573830]	overcooked [-17.807026]	jeopardize [-4.248345]	</s> [-0.398314]	apologize [-18.373930]	medium [-6.953820]	</s> [-1.484147]	chief [-12.834482]	medium [-6.051327]	</s> [-1.413748]	community [-15.336635]	hero [-6.967068]	</s> [-0.616429]	quizzical [-17.309546]	hero [-4.288208]	</s> [-0.626321]	needy [-16.788176]	hero [-3.806231]	</s> [-0.613085]	pleasure [-16.004040]	number [-6.611440]	</s> [-0.543233]	demand [-16.298388]	number [-6.389760]	</s> [-0.570497]	combine [-14.549492]	dehumanize [-7.170847]	</s> [-0.531687]	advice [-15.674726]	key [-7.415393]	</s> [-0.389852]	sick [-18.635786]	mountebank [-4.373034]	</s> [-0.455563]	affect [-16.345572]	smooth [-6.918602]	</s> [-0.673927]	quarterly [-16.070562]	spearhead [-3.578533]	</s> [-0.554625]	trustworthy [-16.642857]	demagnetise [-4.714831]	</s> [-0.550677]	light [-17.417490]	break [-5.297982]	</s> [-0.719355]	lucky [-16.882753]	break [-5.237833]	</s> [-0.670381]	these [-16.695448]	buttonhole [-4.961171]	</s> [-0.664104]	ill-fated [-16.124496]	buttonhole [-5.395449]	</s> [-0.596428]	communication [-15.361904]	constrict [-6.436848]	</s> [-0.498521]	healthy [-17.898655]	reemphasize [-5.607238]	</s> [-0.445517]	unpleasant [-17.535593]	gallivant [-4.896013]	</s> [-0.435346]	lucky [-16.701679]	replenish [-5.086109]	</s> [-0.480721]	trivial [-17.645819]	replenish [-4.896006]	</s> [-0.470975]	manufacturer [-14.934167]	replenish [-6.409751]	</s> [-0.505951]	stretch [-14.816469]	replenish [-7.386920]	</s> [-0.578175]	mail [-15.157681]	crosscheck [-6.368694]	</s> [-0.498269]	needy [-16.925053]	crosscheck [-4.681487]	</s> [-0.482411]	hotel [-14.159814]	commingle [-7.223072]	</s> [-0.619895]	lucky [-16.608994]	commingle [-4.546546]	</s> [-0.598954]	admired [-16.744314]	rubber [-5.273879]	</s> [-0.430416]	precious [-16.901075]	close [-3.782558]	</s> [-0.475182]	pristine [-15.242133]	sweet [-8.700846]	</s> [-1.295172]	a [-13.530664]	sweet [-8.602101]	</s> [-1.240892]	city [-15.973727]	overemphasize [-6.315542]	</s> [-0.495192]	overcooked [-18.381416]	overemphasize [-4.784986]	</s> [-0.511588]	merry [-17.946398]	splash [-4.208319]	</s> [-0.408376]	merry [-17.826153]	soft [-5.245306]	</s> [-0.538878]	regal [-17.403107]	soft [-5.003641]	</s> [-0.575744]	road [-16.084297]	soft [-7.428427]	</s> [-0.583160]	homework [-16.621849]	distemper [-7.264272]	</s> [-0.430090]	trustworthy [-17.257389]	distemper [-5.179308]	</s> [-0.452180]	pale [-17.211870]	distemper [-4.512699]	</s> [-0.470457]	stable [-16.449831]	misconduct [-5.297585]	</s> [-0.432550]	sentimental [-17.880560]	keep [-4.927946]	</s> [-0.310788]	reading [-15.908170]	sound [-6.983340]	</s> [-0.230380]	ladder [-14.669217]	sound [-7.762042]	</s> [-0.250971]	second [-18.249771]	misbehave [-4.734940]	</s> [-0.456883]	troubled [-15.505558]	misbehave [-4.409352]	</s> [-0.443740]	dazzling [-16.077709]	slap [-4.561014]	</s> [-0.453939]	unwritten [-17.817570]	run [-4.341297]	</s> [-0.494535]	unruly [-17.562267]	run [-3.976867]	</s> [-0.435795]	the [-14.501183]	run [-5.628998]	</s> [-0.446985]	an [-13.046864]	run [-5.853958]	</s> [-0.435545]	legitimate [-15.200397]	blind [-4.747668]	</s> [-1.151936]	power [-19.063444]	blind [-6.169350]	</s> [-1.082175]	contract [-14.856466]	intermarry [-6.801130]	</s> [-0.449437]	day [-15.659776]	intermarry [-7.695243]	</s> [-0.445961]	vicious [-17.382393]	stanchion [-5.368720]	</s> [-0.452233]	tasty [-18.299398]	stanchion [-5.697791]	</s> [-0.477966]	assistant [-15.613898]	disembowel [-6.979076]	</s> [-0.643257]	fact [-13.759998]	disembowel [-6.279248]	</s> [-0.650339]	shoe [-14.250375]	get [-6.912225]	</s> [-0.551585]	stained [-18.690079]	headquarter [-5.038197]	</s> [-0.551891]	back [-16.102715]	outbalance [-9.163631]	</s> [-0.578584]	towel [-15.536735]	weird [-8.651100]	</s> [-1.516523]	green [-15.668742]	brutalize [-5.492295]	</s> [-0.476390]	professional [-15.957356]	brutalize [-7.364379]	</s> [-0.524004]	irresponsible [-16.798885]	still [-4.990988]	</s> [-0.560965]	unusual [-16.988850]	still [-5.519490]	</s> [-0.499622]	decisive [-18.440195]	still [-4.819838]	</s> [-0.491247]	showy [-18.764721]	still [-5.031800]	</s> [-0.490948]	kaleidoscopic [-17.595970]	interfere [-4.060800]	</s> [-0.496528]	quarterly [-16.312933]	interfere [-4.438447]	</s> [-0.556161]	player [-16.105827]	crash [-6.717152]	</s> [-0.553782]	outstanding [-18.541294]	overcharge [-4.143000]	</s> [-0.528601]	associate [-15.306624]	overcharge [-6.675799]	</s> [-0.465536]	sector [-15.450251]	disrespect [-8.357165]	</s> [-0.454409]	irresponsible [-16.567287]	disrespect [-4.784931]	</s> [-0.424262]	starry [-17.049183]	listen [-4.857996]	</s> [-0.411830]	mail [-15.191404]	weasel [-6.924412]	</s> [-0.424355]	incomparable [-15.965561]	weasel [-5.256004]	</s> [-0.398027]	unlucky [-18.984678]	bring [-4.985580]	</s> [-0.510025]	care [-14.895206]	bring [-7.245703]	</s> [-0.486011]	peace [-15.757772]	backtrack [-7.770535]	</s> [-0.670800]	combine [-14.578936]	carry [-7.358696]	</s> [-0.637311]	glad [-15.351519]	carry [-7.922789]	</s> [-0.625546]	many [-15.453607]	carry [-7.877156]	</s> [-0.576930]	shrill [-18.352867]	decentralize [-5.364954]	</s> [-0.367181]	unruly [-17.339909]	decentralize [-5.588428]	</s> [-0.414737]	babyish [-18.374113]	decentralize [-5.261027]	</s> [-0.388480]	garbage [-15.050523]	circumcise [-6.152410]	</s> [-0.476190]	currency [-14.943356]	circumcise [-6.322025]	</s> [-0.449215]	mild [-17.588268]	circumcise [-4.490551]	</s> [-0.442854]	elastic [-16.853264]	circumcise [-5.845558]	</s> [-0.518039]	plastic [-14.813708]	inconvenience [-6.137343]	</s> [-0.523580]	site [-15.043896]	inconvenience [-7.139090]	</s> [-0.479233]
2024-12-19 07:30:42 | INFO | fairseq_cli.eval_lm | Evaluated 465 tokens in 0.9s (531.67 tokens/s)
2024-12-19 07:30:42 | INFO | fairseq_cli.eval_lm | Loss (base 2): 10.9084, Perplexity: 1921.99
