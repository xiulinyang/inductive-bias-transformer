2024-12-19 08:35:52 | INFO | fairseq.tasks.text_to_speech | Please install tensorboardX: pip install tensorboardX
2024-12-19 08:35:54 | INFO | fairseq_cli.eval_lm | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': 'checkpoints/grammar41exp1_permutation/4-transformer/checkpoint_best.pt', 'post_process': None, 'quiet': True, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': False, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.25], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': True, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': None, 'task': {'_name': 'language_modeling', 'data': 'data-bin/grammar41exp1_permutation/incorrect_4-dataset', 'sample_break_mode': 'none', 'tokens_per_sample': 512, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 1, 'batch_size': None, 'batch_size_valid': None, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'criterion': {'_name': 'cross_entropy', 'sentence_avg': True}, 'optimizer': None, 'lr_scheduler': {'_name': 'fixed', 'force_anneal': None, 'lr_shrink': 0.1, 'warmup_updates': 0, 'lr': [0.25]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2024-12-19 08:35:54 | INFO | fairseq.tasks.language_modeling | dictionary: 1136 types
2024-12-19 08:35:54 | INFO | fairseq_cli.eval_lm | loading model(s) from checkpoints/grammar41exp1_permutation/4-transformer/checkpoint_best.pt
/workspace/artificial-languages/fairseq/fairseq/checkpoint_utils.py:340: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state = torch.load(f, map_location=torch.device("cpu"))
2024-12-19 08:35:57 | INFO | fairseq_cli.eval_lm | num. model params: 10,038,784
2024-12-19 08:35:57 | INFO | fairseq.data.data_utils | loaded 134 examples from: data-bin/grammar41exp1_permutation/incorrect_4-dataset/test
2024-12-19 08:35:57 | INFO | fairseq_cli.eval_lm | data-bin/grammar41exp1_permutation/incorrect_4-dataset test 1 examples
2024-12-19 08:35:57 | INFO | fairseq.tasks.fairseq_task | can_reuse_epoch_itr = True
2024-12-19 08:35:57 | INFO | fairseq.tasks.fairseq_task | reuse_dataloader = True
2024-12-19 08:35:57 | INFO | fairseq.tasks.fairseq_task | rebuild_batches = False
2024-12-19 08:35:57 | INFO | fairseq.tasks.fairseq_task | creating new batches for epoch 1
2024-12-19 08:35:58 | INFO | fairseq_cli.eval_lm | 0 meek [-15.169068]	brutalize [-4.301349]	</s> [-0.574593]	potable [-15.887248]	brutalize [-4.402408]	</s> [-0.548833]	light [-17.365456]	brutalize [-4.685148]	</s> [-0.672395]	revolving [-17.604465]	racketeer [-5.501029]	</s> [-0.938198]	status [-15.446295]	disembowel [-6.847175]	</s> [-0.678011]	appropriate [-17.731886]	slaughter [-4.411287]	</s> [-0.769660]	figure [-16.652258]	slaughter [-7.555139]	</s> [-0.845698]	cultivated [-17.434883]	headquarter [-4.609754]	</s> [-0.662350]	fill [-15.237920]	apologize [-9.202182]	</s> [-0.634776]	unfolded [-17.546926]	apologize [-5.414286]	</s> [-0.704488]	election [-14.846919]	fertilize [-6.725392]	</s> [-0.929963]	judicious [-19.124950]	fertilize [-4.895705]	</s> [-0.826583]	careful [-17.747688]	misconduct [-4.676091]	</s> [-0.804843]	sentimental [-18.334162]	misconduct [-4.747478]	</s> [-0.840202]	admired [-17.467665]	circumcise [-5.738474]	</s> [-0.666194]	breath [-15.837159]	circumcise [-8.904722]	</s> [-0.656411]	future [-14.136159]	circumcise [-8.498947]	</s> [-0.612471]	afternoon [-15.776888]	misbehave [-8.106499]	</s> [-0.636732]	broken [-20.003139]	misbehave [-5.821797]	</s> [-0.630609]	meek [-16.858702]	misbehave [-5.695117]	</s> [-0.655802]	hundred [-17.954374]	back [-6.060699]	</s> [-0.640127]	voice [-14.712642]	disrespect [-7.634479]	</s> [-0.646256]	admired [-17.804707]	disrespect [-4.410279]	</s> [-0.627982]	sense [-14.288846]	privilege [-8.328418]	</s> [-0.642357]	needy [-18.169430]	come [-4.313908]	</s> [-0.895431]	mountainous [-19.373558]	blaspheme [-4.982471]	</s> [-0.812374]	flaky [-19.123308]	blaspheme [-4.919000]	</s> [-0.842375]	electric [-18.039972]	outbalance [-4.968271]	</s> [-0.697508]	kosher [-18.126085]	outbalance [-5.003746]	</s> [-0.695311]	regal [-17.193724]	outbalance [-5.161505]	</s> [-0.628889]	pristine [-17.179113]	number [-5.286753]	</s> [-0.772142]	incomparable [-17.940514]	criticise [-5.051634]	</s> [-0.736242]	fun [-15.617270]	criticise [-7.838171]	</s> [-0.704111]	lonely [-17.457523]	criticise [-4.959394]	</s> [-0.739191]	pungent [-17.947565]	blackguard [-4.962665]	</s> [-0.738664]	unwritten [-18.700256]	blackguard [-4.314631]	</s> [-0.688934]	pristine [-17.036781]	constrict [-4.348046]	</s> [-0.591567]	friendship [-14.579646]	introvert [-7.457418]	</s> [-0.686240]	lonely [-17.142750]	interchange [-4.482156]	</s> [-0.755152]	street [-14.856882]	interchange [-7.467055]	</s> [-0.786104]	mail [-15.047207]	listen [-6.573630]	</s> [-0.659834]	tattered [-18.070520]	listen [-3.812336]	</s> [-0.699447]	vicious [-16.858074]	listen [-4.286193]	</s> [-0.821079]	formal [-18.671076]	break [-5.298410]	</s> [-0.696223]	break [-17.830151]	blind [-6.054371]	</s> [-1.277821]	come [-18.758553]	blind [-5.916891]	</s> [-1.247686]	gene [-15.988247]	soft [-7.314381]	</s> [-0.685193]	responsible [-15.649776]	rediscover [-3.947711]	</s> [-0.741828]	smile [-16.058857]	replenish [-7.711394]	</s> [-0.514794]	routine [-15.842262]	replenish [-7.457858]	</s> [-0.499299]	barren [-18.509733]	track [-4.808421]	</s> [-0.572375]	fill [-15.318348]	dillydally [-9.220329]	</s> [-0.589804]	extra-small [-18.228058]	give [-4.262413]	</s> [-0.656426]	opposite [-16.042181]	decentralize [-7.189172]	</s> [-0.641118]	potential [-14.963006]	decentralize [-7.234285]	</s> [-0.565697]	press [-15.287795]	decentralize [-7.631463]	</s> [-0.548639]	formal [-18.746357]	folk [-4.766177]	</s> [-0.800149]	quirky [-17.794722]	folk [-5.053272]	</s> [-0.789070]	powerless [-17.773972]	bring [-4.223416]	</s> [-0.886143]	careful [-17.340023]	bring [-4.146175]	</s> [-0.862649]	this [-18.033453]	get [-5.325336]	</s> [-0.727811]	quarterly [-17.207518]	burlesque [-5.189694]	</s> [-0.542015]	tax [-14.844553]	burlesque [-9.502386]	</s> [-0.582344]	responsible [-15.926344]	booby [-5.250152]	</s> [-0.704769]	office [-15.555903]	booby [-7.725007]	</s> [-0.648846]	wary [-15.509253]	secularize [-4.660371]	</s> [-0.531736]	engine [-16.881847]	secularize [-7.172975]	</s> [-0.562416]	extra-small [-18.174891]	interfere [-4.721272]	</s> [-0.597550]	shabby [-17.454456]	interfere [-4.956185]	</s> [-0.587245]	slippery [-17.922363]	prejudice [-4.983587]	</s> [-0.615727]	major [-18.437151]	hero [-4.624605]	</s> [-0.531281]	outstanding [-17.955555]	intellectualize [-4.963041]	</s> [-0.564610]	vacation [-15.851200]	stanchion [-8.219835]	</s> [-0.622668]	issue [-15.320607]	stanchion [-8.274762]	</s> [-0.656529]	hearing [-14.741142]	stanchion [-7.870963]	</s> [-0.665210]	utilized [-18.682934]	sneeze [-4.530190]	</s> [-0.617610]	well-to-do [-17.406109]	inconvenience [-4.533490]	</s> [-0.625140]	request [-15.743377]	rubber [-8.580379]	</s> [-0.577220]	dazzling [-16.897461]	provision [-4.771552]	</s> [-0.577927]	guest [-15.696047]	provision [-7.142652]	</s> [-0.562775]	oddball [-18.285421]	provision [-4.862049]	</s> [-0.565661]	naive [-17.640572]	sound [-4.277858]	</s> [-0.743967]	big-hearted [-18.533945]	commingle [-5.181606]	</s> [-0.891979]	race [-15.673947]	overemphasize [-8.783581]	</s> [-0.591466]	shabby [-17.446489]	bump [-4.883145]	</s> [-0.510962]	prompt [-15.613298]	bump [-7.077858]	</s> [-0.512152]	unpleasant [-16.127329]	bump [-4.427659]	</s> [-0.452718]	calendar [-14.865969]	bump [-7.809081]	</s> [-0.458804]	quarterly [-17.298281]	jeopardize [-4.546529]	</s> [-0.732802]	the [-13.395733]	medium [-7.931109]	</s> [-1.261096]	precious [-18.641556]	square [-5.936529]	</s> [-0.713939]	moment [-14.559995]	follow [-7.991769]	</s> [-1.156091]	notable [-17.368643]	follow [-4.600493]	</s> [-1.075507]	pie [-15.298814]	smooth [-8.288715]	</s> [-0.678021]	special [-15.325649]	smooth [-7.005539]	</s> [-0.657948]	careful [-17.458494]	commercialize [-4.734802]	</s> [-0.621853]	join [-16.115107]	run [-7.337961]	</s> [-0.670518]	combine [-15.460536]	run [-6.312185]	</s> [-0.646169]	all [-17.966997]	weasel [-4.469491]	</s> [-0.606235]	government [-14.593909]	rustle [-8.513338]	</s> [-0.630200]	major [-18.634474]	choke [-4.268961]	</s> [-0.771370]	unsightly [-16.513487]	hydroplane [-4.675874]	</s> [-0.634101]	contract [-15.222305]	hydroplane [-8.999445]	</s> [-0.653886]	utilized [-18.970945]	hydroplane [-4.855345]	</s> [-0.676196]	babyish [-15.981405]	buttonhole [-4.480525]	</s> [-0.911493]	memory [-14.553338]	close [-8.190886]	</s> [-0.806795]	green [-16.412457]	close [-4.662926]	</s> [-0.752518]	powerless [-18.057407]	close [-4.854660]	</s> [-0.825059]	ashamed [-18.402355]	undervalue [-4.761731]	</s> [-0.598933]	judicious [-18.788231]	overspecialize [-5.018763]	</s> [-0.733783]	league [-15.121447]	promenade [-7.531910]	</s> [-0.644487]	invite [-15.282229]	still [-7.888245]	</s> [-0.616016]	troubled [-17.421696]	slap [-4.359327]	</s> [-0.560924]	scaly [-17.030485]	mispronounce [-4.902122]	</s> [-0.648970]	pungent [-18.214479]	mispronounce [-5.504539]	</s> [-0.858307]	headquarter [-17.890249]	sweet [-6.225200]	</s> [-1.393294]	elastic [-16.674677]	mountebank [-4.950683]	</s> [-0.606965]	unwritten [-18.731220]	mountebank [-4.747672]	</s> [-0.643119]	heavenly [-17.983652]	bucket [-4.560849]	</s> [-0.523199]	uneven [-17.248232]	bucket [-4.746632]	</s> [-0.526970]	unlucky [-17.405399]	pressurize [-4.843892]	</s> [-0.801007]	this [-18.520409]	influence [-5.667377]	</s> [-0.899324]	winged [-17.581030]	dress [-4.849170]	</s> [-0.734107]	might [-13.958821]	dress [-7.272777]	</s> [-0.777830]	scaly [-17.081568]	crosscheck [-4.428156]	</s> [-0.677694]	housing [-14.575105]	crosscheck [-7.478555]	</s> [-0.780501]	motionless [-17.220186]	crosscheck [-4.315900]	</s> [-0.800730]	vague [-13.395950]	weird [-6.081567]	</s> [-1.295189]	kosher [-18.130148]	intercede [-4.713963]	</s> [-0.650732]	haunting [-17.850260]	intercede [-4.923753]	</s> [-0.614090]	trade [-15.559329]	reemphasize [-8.353905]	</s> [-0.538905]	quarterly [-17.758568]	reemphasize [-5.051014]	</s> [-0.574108]	appropriate [-16.927702]	reemphasize [-4.575301]	</s> [-0.519554]	tourist [-14.334143]	spearhead [-6.767825]	</s> [-0.695191]
2024-12-19 08:35:58 | INFO | fairseq_cli.eval_lm | Evaluated 402 tokens in 1.1s (369.30 tokens/s)
2024-12-19 08:35:58 | INFO | fairseq_cli.eval_lm | Loss (base 2): 11.2511, Perplexity: 2437.29
